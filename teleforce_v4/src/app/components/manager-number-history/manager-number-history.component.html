<div mat-dialog-head class="dilog-head d-flex justify-content-between">
    <h3 class="primary">Call History</h3>
    <div class="d-inline-block">
        <a class="close" (click)="openDialog()"><i class="fi-rr-cross-small"></i></a>
    </div>
</div>
<div mat-dialog-content>
    <!---- Table history ---->
    <div class="card mb-4 mt-3">

        <!--Progress Bar-->
        <mat-progress-bar mode="indeterminate" *ngIf="isLoading"></mat-progress-bar>     
  
        <div class="card-body">
            <mat-tab-group (selectedTabChange)="onTabClick($event)">
                <mat-tab label="History">
                    <div fxLayout fxLayoutAlign="center center" class="mt-2">
                        <button mat-raised-button color="primary"
                            (click)="exporter2.exportTable('csv', {fileName:'call-history', sheet: 'sheet_name'})">CSV</button>&nbsp;&nbsp;
                            <!-- <button mat-raised-button color="primary"
                            (click)="audiodownloadzip();">Audio Download Zip</button> -->
                    </div>
                  
                    <div class="table-responsive mt-2">
            
                        <table mat-table matTableExporter #exporter2="matTableExporter" [dataSource]="scheduledataSource" matSort>
                                
                        <!-- Position Column -->
                        <ng-container matColumnDef="id">
                            <th mat-header-cell *matHeaderCellDef> Sr. No. </th>
                            <td mat-cell *matCellDef="let row;let i = index;" data-label="id">
                                {{i+1+(schedulepaginator.pageIndex * schedulepaginator.pageSize)}}
                            </td>
                        </ng-container>
                    
                        <!--  calltime Column -->
                        <ng-container matColumnDef="calltime">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header> Call Time  </th>
                            <td mat-cell *matCellDef="let row">
                                {{row.CallStartTime | date: 'dd-MM-yyyy H:mm:s':timezone}}
                            </td>
                        </ng-container>
        
                        <!--  callername Column -->
                        <ng-container matColumnDef="callername">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header> Caller Name  </th>
                            <td mat-cell *matCellDef="let row">
                                {{row.CallerName}}
                            </td>
                        </ng-container>
        
                        <!--  callerno Column -->
                        <ng-container matColumnDef="callerno">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header> Caller Number   </th>
                            <td mat-cell *matCellDef="let row">
                                {{row.CallerNumber}}
                            </td>
                        </ng-container>
        
                        <!--  duration Column -->
                        <ng-container matColumnDef="duration">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header> Duration   </th>
                            <td mat-cell *matCellDef="let row">
                                {{row.CallTalkTime}}
                            </td>
                        </ng-container>
        
                        <!--  duration Column -->
                        <ng-container matColumnDef="type">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header>  Call Type    </th>
                            <td mat-cell *matCellDef="let row">
                                {{row.CallType | titlecase}}
                            </td>
                        </ng-container>
        
                        <!--  status Column -->
                        <ng-container matColumnDef="status">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header> Status </th>
                            <td mat-cell *matCellDef="let row">
                                {{row.CallStatus}}
                            </td>
                        </ng-container>
        
                        <!--  agent Column -->
                        <ng-container matColumnDef="agent">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header> Agent </th>
                            <td mat-cell *matCellDef="let row">
                                {{row.AgentName}}
                            </td>
                        </ng-container>
        
                        <!--  feedback Column -->
                        <ng-container matColumnDef="feedback">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header> Feedback </th>
                            <td mat-cell *matCellDef="let row">
                                {{row.feedback | titlecase}}
                            </td>
                        </ng-container>
        
                        <!--  note Column -->
                        <ng-container matColumnDef="note">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header> Note </th>
                            <td mat-cell *matCellDef="let row">
                                {{row.note | titlecase}}
                            </td>
                        </ng-container>
                    
                        <tr mat-header-row *matHeaderRowDef="scheduleColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: scheduleColumns;"></tr>
                        </table>            
                    </div>
          
                    <!--Paginator-->
                    <mat-paginator #schedulepaginator [length]="scheduleLength" [pageSize]="5"
                    [pageSizeOptions]="[5]"></mat-paginator>
                </mat-tab>
                <mat-tab label="Routing Detail" *ngIf="calltype==2">
                    <div fxLayout fxLayoutAlign="center center" class="mt-2">
                        <button mat-raised-button color="primary"
                            (click)="exporter.exportTable('csv', {fileName:'routing-detail', sheet: 'sheet_name'})">CSV</button>&nbsp;&nbsp;                            
                    </div>
                  
                    <div class="table-responsive mt-2">
            
                        <table mat-table matTableExporter #exporter="matTableExporter" [dataSource]="dataSource" matSort>
                                
                        <!-- Position Column -->
                        <ng-container matColumnDef="id">
                            <th mat-header-cell *matHeaderCellDef> Sr. No. </th>
                            <td mat-cell *matCellDef="let row;let i = index;" data-label="id">
                                {{i+1+(paginator.pageIndex * paginator.pageSize)}}
                            </td>
                        </ng-container>
                        <!--  agent Column -->
                        <ng-container matColumnDef="name">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header> Agent </th>
                            <td mat-cell *matCellDef="let row">
                                {{row.account_name}}
                            </td>
                        </ng-container>                        
                        <!--  status Column -->
                        <ng-container matColumnDef="callernumber">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header>Call Number </th>
                            <td mat-cell *matCellDef="let row">
                                {{row.callernumber}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="callstatus">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header>Call Status </th>
                            <td mat-cell *matCellDef="let row">
                                {{row.callstatus}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="calldate">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header> Call Date </th>
                            <td mat-cell *matCellDef="let row">
                                {{row.calldate | date: 'dd-MM-yyyy H:mm:s':timezone}}
                            </td>
                        </ng-container>
        
                        
                        <tr mat-header-row *matHeaderRowDef="dataColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: dataColumns                            ;"></tr>
                        </table>            
                    </div>
          
                    <!--Paginator-->
                    <mat-paginator #paginator [length]="dataLength" [pageSize]="5"
                    [pageSizeOptions]="[5]"></mat-paginator>
                </mat-tab>
                <mat-tab label="IVR Routing Detail" *ngIf="calltype==2">
                    <div fxLayout fxLayoutAlign="center center" class="mt-2">
                        <button mat-raised-button color="primary"
                            (click)="exporter.exportTable('csv', {fileName:'IVR-routing-detail', sheet: 'sheet_name'})">CSV</button>&nbsp;&nbsp;                            
                    </div>
                  
                    <div class="table-responsive mt-2">
            
                        <table mat-table matTableExporter #exporter="matTableExporter" [dataSource]="ivrdataSource" matSort>
                                
                        <!-- Position Column -->
                        <ng-container matColumnDef="id">
                            <th mat-header-cell *matHeaderCellDef> Sr. No. </th>
                            <td mat-cell *matCellDef="let row;let i = index;" data-label="id">
                                {{i+1+(paginator.pageIndex * paginator.pageSize)}}
                            </td>
                        </ng-container>
                        <!--  agent Column -->
                        <ng-container matColumnDef="ivrid">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header> IVR Id </th>
                            <td mat-cell *matCellDef="let row">
                                {{row.ivrid}}
                            </td>
                        </ng-container>                        
                        <!--  status Column -->
                        <ng-container matColumnDef="ivrname">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header>IVR Name</th>
                            <td mat-cell *matCellDef="let row">
                                {{row.ivrname}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="extension">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header>Extension </th>
                            <td mat-cell *matCellDef="let row">
                                {{row.extension}}
                            </td>
                        </ng-container>
                     
        
                        
                        <tr mat-header-row *matHeaderRowDef="ivrColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: ivrColumns                            ;"></tr>
                        </table>            
                    </div>
          
                    <!--Paginator-->
                    <mat-paginator #ivrpaginator [length]="ivrLength" [pageSize]="5"
                    [pageSizeOptions]="[5]"></mat-paginator>
                </mat-tab>
            </mat-tab-group>
            <!-- Btn-->
            
  
        </div>
    </div>
</div>