<div class="warap-height pt-4">  
  <!-- Begin Page Content -->  
  <div class="container-fluid">

    <!-- Page Heading -->
    <h1 class="h3 mb-2 text-gray-800">Voice Campaign</h1>
    <form [formGroup]="searchform" >
      <div class="row">
        <div class="col-12 col-md-4 col-lg-3 col-xl-2 col-sm-6 mt-2">
          <mat-form-field appearance="outline">
            <mat-label>Start Date</mat-label>
            <input matInput placeholder="Start Date" [matDatepicker]="startpicker" formControlName="startdate">
            <mat-datepicker-toggle matSuffix [for]="startpicker"></mat-datepicker-toggle>
            <mat-datepicker #startpicker tpicker></mat-datepicker>
          </mat-form-field>
        </div>
        <div class="col-12 col-md-4 col-lg-3 col-xl-2 col-sm-6 mt-2">
          <mat-form-field appearance="outline">
            <mat-label>End Date</mat-label>
            <input matInput placeholder="End Date" [matDatepicker]="endpicker" formControlName="enddate">
            <mat-datepicker-toggle matSuffix [for]="endpicker"></mat-datepicker-toggle>
            <mat-datepicker #endpicker tpicker></mat-datepicker>
          </mat-form-field>
        </div>
        <div class="col-12 col-md-4 col-lg-3 col-xl-2 col-sm-6 mt-2">
          <mat-form-field appearance="outline">
            <mat-label>Campaign Type</mat-label>
            <mat-select formControlName="cam_type">
              <mat-option value="">All</mat-option>
              <mat-option value="0">Outbound Calling</mat-option>
              <mat-option value="1">Assign to Lead</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <!--<div class="col-12 col-md-4 col-lg-3 col-xl-2 col-sm-6 mt-2">
          <mat-form-field appearance="outline">
            <mat-label>Method</mat-label>
            <mat-select formControlName="cam_method">
              <mat-option value="">All</mat-option>
              <mat-option value="0">Live Agent</mat-option>
              <mat-option value="1">OBD</mat-option>
            </mat-select>
          </mat-form-field>
        </div>-->
       
        <!-- <div class="col-12 col-md-4 col-lg-3 col-xl-2 col-sm-6 mt-2">
          <mat-form-field appearance="outline">
            <mat-label>Status</mat-label>
            <mat-select formControlName="cam_status">
              <mat-option value="">All</mat-option>
              <mat-option value="0">Schedule</mat-option>
              <mat-option value="1">Running</mat-option>
              <mat-option value="2">Completed</mat-option>
            </mat-select>
          </mat-form-field>
        </div> -->
        
       
        <div class="col-12 col-md-4 col-lg-3 col-xl-3 col-sm-6 mt-2">
          <!-- <button mat-raised-button type="submit" color="primary" class="Update-btn">Search</button>&nbsp; -->
          <button mat-raised-button type="submit" class="mt-2"(click)="searchData()"   [disabled]="isDisabled">Search</button>&nbsp;
          <button mat-raised-button color="warn" class="mt-2" (click)="resetform()">Reset</button>&nbsp;
       
        </div>
      </div>
    </form>
    <!---- Table history ---->
    <div class="card shadow mb-4 mt-3">

      <!--Progress Bar-->

      <div class="card-body">

        <!--Add Campaign Btn-->
        <button mat-raised-button color="primary" (click)="createcontactdialog()" title="Add">Create Campaign</button>
        
        <div class="table-responsive mt-2">
          <mat-tab-group (selectedTabChange)="onTabClick($event)">
            <mat-tab label="Schedule">
              <mat-progress-bar mode="indeterminate" *ngIf="isLoading"></mat-progress-bar>

              <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8">
                        
                <!-- Position Column -->
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef> Sr. No. </th>
                    <td mat-cell *matCellDef="let row;let i = index;">
                      {{i+1+(paginator.pageIndex * paginator.pageSize)}}
                    </td>
                </ng-container>
            
                <!--  Create Date Column -->
                <ng-container matColumnDef="date">
                    <th mat-header-cell *matHeaderCellDef  mat-sort-header> Create Date  </th>
                    <td mat-cell *matCellDef="let row">
                      {{row.create_date | date:'dd-MM-yyyy'}}
                    </td>
                </ng-container>

                <!--  name Column -->
                <ng-container matColumnDef="name">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> Name  </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.cam_name}}
                  </td>
                </ng-container>

                <!--  name Column -->
                <ng-container matColumnDef="camid">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> ID  </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.camid}}
                  </td>
                </ng-container>

                <!--  type Column -->
                <ng-container matColumnDef="type">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> Type  </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.cam_type=='0'?'Outbound Calling':''}}
                    {{row.cam_type=='1'?'Lead Assign to Agent':''}}
                  </td>
                </ng-container>

                <!--  method Column -->
                <ng-container matColumnDef="method">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> Method  </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.cam_method=='0'?'Live Agent':''}}
                    {{row.cam_method=='1'?'OBD':''}}
                    {{row.cam_method=='2'?'Mobile Dialer':''}}
                  </td>
                </ng-container>

                <ng-container matColumnDef="dailertype">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> Dailer Type  </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.dialer_type	=='0'?'Progressive':''}}
                    {{row.dialer_type	=='1'?'Predective':''}}
                  </td>
                </ng-container>
                <!--  status Column -->
                <ng-container matColumnDef="status">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> Status  </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.cam_status=='0'?'Schedule':''}}
                    {{row.cam_status=='1'?'Running':''}}
                    {{row.cam_status=='2'?'Completed':''}}
                  </td>
                </ng-container>

                <!-- Action Column -->
                <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef> Action </th>
                    <td mat-cell *matCellDef="let row">      
                      <div class="d-flex"> 
                        <button mat-icon-button color="accent" routerLink="/campaign-detail/{{row.camid}}" aria-label="Example icon button with a menu icon">
                          <mat-icon>source</mat-icon>
                        </button>
                        <!-- <div  *ngIf="row.cam_method == 0">
                          <button mat-icon-button color="accent"  (click)="Assignagent(row.camid)" aria-label="Example icon button with a menu icon">
                            <mat-icon>accessibility</mat-icon>
                          </button>
                        </div> -->
                      
                        <div *ngIf="row.cam_type==0 && progressivedialer" class="ml-2">
                          <button mat-flat-button *ngIf="row.cam_action==0 || row.cam_action==2" class="start-campaign mt-1"
                            (click)="changeaction(row.camid,1)">Start</button>&nbsp;
                          <button class="mt-1" mat-flat-button *ngIf="row.cam_action==1" (click)="stopcampaign(row.camid,2)"
                            color="warn">Stop</button>
                        </div>
                        <button mat-icon-button color="warn" (click)="deleteagentdialog(row.camid)" aria-label="Example icon button with a menu icon" *ngIf="row.lms_agentid==0 || row.deleted !='no'">
                          <mat-icon>delete</mat-icon>
                        </button> 
                        <!-- <button mat-icon-button color="warn" (click)="deleteagentdialog(row.camid)" aria-label="Example icon button with a menu icon" *ngIf="lms_delete_agent_camp">
                          <mat-icon>delete</mat-icon>
                        </button>  -->
                      </div> 
                    </td>
                </ng-container>
            
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
              </table>  
              <mat-paginator #paginator [length]="contactLength" [pageSize]="50" [pageSizeOptions]="[50,100,500]" showFirstLastButtons="true">
              </mat-paginator>
            </mat-tab>
            <mat-tab label="Running">
              <mat-progress-bar mode="indeterminate" *ngIf="runnigisLoading"></mat-progress-bar>

              <table mat-table [dataSource]="runningdataSource" matSort class="mat-elevation-z8">
                        
                <!-- Position Column -->
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef> Sr. No. </th>
                    <td mat-cell *matCellDef="let row;let i = index;">
                      {{i+1+(paginator.pageIndex * paginator.pageSize)}}
                    </td>
                </ng-container>
            
                <!--  Create Date Column -->
                <ng-container matColumnDef="date">
                    <th mat-header-cell *matHeaderCellDef  mat-sort-header> Create Date  </th>
                    <td mat-cell *matCellDef="let row">
                      {{row.create_date | date:'dd-MM-yyyy'}}
                    </td>
                </ng-container>

                <!--  name Column -->
                <ng-container matColumnDef="name">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> Name  </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.cam_name}}
                  </td>
                </ng-container>

                <!--  name Column -->
                <ng-container matColumnDef="camid">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> ID  </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.camid}}
                  </td>
                </ng-container>

                <!--  type Column -->
                <ng-container matColumnDef="type">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> Type  </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.cam_type=='0'?'Outbound Calling':''}}
                    {{row.cam_type=='1'?'Lead Assign to Agent':''}}
                  </td>
                </ng-container>

                <!--  method Column -->
                <ng-container matColumnDef="method">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> Method  </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.cam_method=='0'?'Live Agent':''}}
                    {{row.cam_method=='1'?'OBD':''}}
                    {{row.cam_method=='2'?'Mobile Dialer':''}}
                  </td>
                </ng-container>

                <ng-container matColumnDef="dailertype">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> Dailer Type  </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.dialer_type	=='0'?'Progressive':''}}
                    {{row.dialer_type	=='1'?'Predective':''}}
                  </td>
                </ng-container>
                <!--  status Column -->
                <ng-container matColumnDef="status">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> Status  </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.cam_status=='0'?'Schedule':''}}
                    {{row.cam_status=='1'?'Running':''}}
                    {{row.cam_status=='2'?'Completed':''}}
                  </td>
                </ng-container>

                <!-- Action Column -->
                <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef> Action </th>
                    <td mat-cell *matCellDef="let row">      
                      <div class="d-flex"> 
                        <button mat-icon-button color="accent" routerLink="/campaign-detail/{{row.camid}}" aria-label="Example icon button with a menu icon">
                          <mat-icon>source</mat-icon>
                        </button>
                        <!-- <div  *ngIf="row.cam_method == 0">
                          <button mat-icon-button color="accent"  (click)="Assignagent(row.camid)" aria-label="Example icon button with a menu icon">
                            <mat-icon>accessibility</mat-icon>
                          </button>
                        </div> -->
                      
                        <div *ngIf="row.cam_type==0 && progressivedialer" class="ml-2">
                          <button mat-flat-button *ngIf="row.cam_action==0 || row.cam_action==2" class="start-campaign mt-1"
                            (click)="changeaction(row.camid,1)">Start</button>&nbsp;
                          <button class="mt-1" mat-flat-button *ngIf="row.cam_action==1" (click)="stopcampaign(row.camid,2)"
                            color="warn">Stop</button>
                        </div>
                        <button mat-icon-button color="warn" (click)="deleteagentdialog(row.camid)" aria-label="Example icon button with a menu icon" *ngIf="row.lms_agentid==0 || row.deleted !='no'">
                          <mat-icon>delete</mat-icon>
                        </button> 
                      </div> 
                    </td>
                </ng-container>
            
                <tr mat-header-row *matHeaderRowDef="runningdisplayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: runningdisplayedColumns;"></tr>
              </table>  
              <mat-paginator #runnigpaginator [length]="runnigLength" [pageSize]="50" [pageSizeOptions]="[50,100,500]" showFirstLastButtons="true">
              </mat-paginator>
            </mat-tab>
            
            <mat-tab label="Completed">
              <mat-progress-bar mode="indeterminate" *ngIf="complateisLoading"></mat-progress-bar>

              <table mat-table [dataSource]="complatedataSource" matSort class="mat-elevation-z8">
                        
                <!-- Position Column -->
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef> Sr. No. </th>
                    <td mat-cell *matCellDef="let row;let i = index;">
                      {{i+1+(paginator.pageIndex * paginator.pageSize)}}
                    </td>
                </ng-container>
            
                <!--  Create Date Column -->
                <ng-container matColumnDef="date">
                    <th mat-header-cell *matHeaderCellDef  mat-sort-header> Create Date  </th>
                    <td mat-cell *matCellDef="let row">
                      {{row.create_date | date:'dd-MM-yyyy'}}
                    </td>
                </ng-container>

                <!--  name Column -->
                <ng-container matColumnDef="name">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> Name  </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.cam_name}}
                  </td>
                </ng-container>

                <!--  name Column -->
                <ng-container matColumnDef="camid">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> ID  </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.camid}}
                  </td>
                </ng-container>

                <!--  type Column -->
                <ng-container matColumnDef="type">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> Type  </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.cam_type=='0'?'Outbound Calling':''}}
                    {{row.cam_type=='1'?'Lead Assign to Agent':''}}
                  </td>
                </ng-container>

                <!--  method Column -->
                <ng-container matColumnDef="method">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> Method  </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.cam_method=='0'?'Live Agent':''}}
                    {{row.cam_method=='1'?'OBD':''}}
                    {{row.cam_method=='2'?'Mobile Dialer':''}}
                  </td>
                </ng-container>

                <ng-container matColumnDef="dailertype">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> Dailer Type  </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.dialer_type	=='0'?'Progressive':''}}
                    {{row.dialer_type	=='1'?'Predective':''}}
                  </td>
                </ng-container>
                <!--  status Column -->
                <ng-container matColumnDef="status">
                  <th mat-header-cell *matHeaderCellDef  mat-sort-header> Status  </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.cam_status=='0'?'Schedule':''}}
                    {{row.cam_status=='1'?'Running':''}}
                    {{row.cam_status=='2'?'Completed':''}}
                  </td>
                </ng-container>

                <!-- Action Column -->
                <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef> Action </th>
                    <td mat-cell *matCellDef="let row">      
                      <div class="d-flex"> 
                        <button mat-icon-button color="accent" routerLink="/campaign-detail/{{row.camid}}" aria-label="Example icon button with a menu icon">
                          <mat-icon>source</mat-icon>
                        </button>
                        <!-- <div  *ngIf="row.cam_method == 0">
                          <button mat-icon-button color="accent"  (click)="Assignagent(row.camid)" aria-label="Example icon button with a menu icon">
                            <mat-icon>accessibility</mat-icon>
                          </button>
                        </div> -->
                      
                        <button mat-icon-button color="warn" (click)="deleteagentdialog(row.camid)" aria-label="Example icon button with a menu icon" *ngIf="row.lms_agentid==0  || row.deleted !='no'">
                          <mat-icon>delete</mat-icon>
                        </button> 
                      </div> 
                    </td>
                </ng-container>
            
                <tr mat-header-row *matHeaderRowDef="complatedisplayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: complatedisplayedColumns;"></tr>
              </table>  
              <mat-paginator #paginator [length]="compalteLength" [pageSize]="50" [pageSizeOptions]="[50,100,500]" showFirstLastButtons="true">
              </mat-paginator>
            </mat-tab>
          </mat-tab-group>
        </div>
        
        <!--Paginator-->
      

      </div>
    </div>
  </div>

</div>